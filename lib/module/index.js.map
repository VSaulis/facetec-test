{"version":3,"names":["React","useRef","useEffect","requireNativeComponent","UIManager","UIManagerWithMissingProp","Platform","NativeModules","PixelRatio","findNodeHandle","defaultCustomization","LINKING_ERROR","select","ios","default","ComponentName","OS","FacetecViewManager","getViewManagerConfig","Error","Facetec","Proxy","get","createFragment","viewId","dispatchViewManagerCommand","Commands","create","toString","AndroidFacetecView","mode","show","onStateUpdate","vocalGuidanceMode","config","customization","ref","onUpdate","event","status","nativeEvent","faceScanBase64","load","current","height","getPixelSizeForLayoutSize","width","IOSFacetecView","flex","initialize","productionKeyText","deviceKeyIdentifier","faceScanEncryptionKey","sessionToken","init","FacetecView","android"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport { useRef, useEffect } from 'react';\nimport {\n  requireNativeComponent,\n  UIManager as UIManagerWithMissingProp,\n  UIManagerStatic,\n  Platform,\n  NativeModules,\n  PixelRatio,\n  findNodeHandle,\n} from 'react-native';\nimport { defaultCustomization } from './customization';\n\nconst LINKING_ERROR =\n  `The package 'react-native-facetec' doesn't seem to be linked. Make sure: \\n\\n` +\n  Platform.select({ ios: \"- You have run 'pod install'\\n\", default: '' }) +\n  '- You rebuilt the app after installing the package\\n' +\n  '- You are not using Expo managed workflow\\n';\n\nconst ComponentName =\n  Platform.OS === 'ios' ? 'FaceTecView' : 'FacetecViewManager';\n\nconst UIManager = UIManagerWithMissingProp as UIManagerStatic & {\n  FacetecViewManager: any;\n};\n\nconst FacetecViewManager =\n  UIManager.getViewManagerConfig(ComponentName) != null\n    ? requireNativeComponent<Types.FacetecProps>(ComponentName)\n    : () => {\n        throw new Error(LINKING_ERROR);\n      };\n\nconst Facetec = NativeModules.Facetec\n  ? NativeModules.Facetec\n  : new Proxy(\n      {},\n      {\n        get() {\n          throw new Error(LINKING_ERROR);\n        },\n      }\n    );\n\nconst createFragment = (viewId: number | null) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // we are calling the 'create' command\n    UIManager.FacetecViewManager.Commands.create.toString(),\n    [viewId]\n  );\n\nconst AndroidFacetecView = ({\n  mode,\n  show = false,\n  onStateUpdate,\n  vocalGuidanceMode,\n  config,\n  customization = defaultCustomization,\n}: Types.FacetecViewProps) => {\n  const ref = useRef(null);\n\n  const onUpdate = (event: any) => {\n    const status = event?.nativeEvent?.status as Types.FacetecStatus;\n    const faceScanBase64 = event?.nativeEvent?.faceScanBase64 as String;\n    if (onStateUpdate && status)\n      onStateUpdate({\n        status,\n        load: {\n          faceScanBase64,\n        },\n      });\n  };\n\n  useEffect(() => {\n    if (show) {\n      const viewId = findNodeHandle(ref.current);\n      createFragment(viewId);\n    }\n  }, [show]);\n\n  if (!show) return null;\n\n  return (\n    <FacetecViewManager\n      style={{\n        // converts dpi to px, provide desired height\n        height: PixelRatio.getPixelSizeForLayoutSize(0),\n        // converts dpi to px, provide desired width\n        width: PixelRatio.getPixelSizeForLayoutSize(0),\n      }}\n      {...config}\n      // @ts-ignore\n      mode={mode}\n      vocalGuidanceMode={vocalGuidanceMode}\n      onUpdate={onUpdate}\n      customization={customization}\n      ref={ref}\n    />\n  );\n};\n\nconst IOSFacetecView = ({}) => {\n  // @ts-ignore\n  return <FacetecViewManager style={{ flex: 1 }} />;\n};\n\nfunction initialize(config: Types.FacetecConfig): Promise<boolean> {\n  const {\n    productionKeyText,\n    deviceKeyIdentifier,\n    faceScanEncryptionKey,\n    sessionToken,\n  } = config;\n  return Facetec.init(\n    productionKeyText,\n    deviceKeyIdentifier,\n    faceScanEncryptionKey,\n    sessionToken\n  );\n}\n\nconst FacetecView = Platform.select({\n  ios: IOSFacetecView,\n  android: AndroidFacetecView,\n});\n\ntype FacetecViewProps = Types.FacetecViewProps;\ntype FacetecViewConfig = Types.FacetecViewConfig;\ntype FacetecStatus = Types.FacetecStatus;\ntype FacetecState = Types.FacetecState;\nexport {\n  defaultCustomization,\n  initialize,\n  FacetecView,\n  FacetecViewProps,\n  FacetecViewConfig,\n  FacetecStatus,\n  FacetecState,\n};\n"],"mappings":"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"}