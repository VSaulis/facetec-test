{"version":3,"names":["LINKING_ERROR","Platform","select","ios","default","ComponentName","OS","UIManager","UIManagerWithMissingProp","FacetecViewManager","getViewManagerConfig","requireNativeComponent","Error","Facetec","NativeModules","Proxy","get","createFragment","viewId","dispatchViewManagerCommand","Commands","create","toString","AndroidFacetecView","mode","show","onStateUpdate","vocalGuidanceMode","config","customization","defaultCustomization","ref","useRef","onUpdate","event","status","nativeEvent","faceScanBase64","load","useEffect","findNodeHandle","current","height","PixelRatio","getPixelSizeForLayoutSize","width","IOSFacetecView","flex","initialize","productionKeyText","deviceKeyIdentifier","faceScanEncryptionKey","sessionToken","init","FacetecView","android"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport { useRef, useEffect } from 'react';\nimport {\n  requireNativeComponent,\n  UIManager as UIManagerWithMissingProp,\n  UIManagerStatic,\n  Platform,\n  NativeModules,\n  PixelRatio,\n  findNodeHandle,\n} from 'react-native';\nimport { defaultCustomization } from './customization';\n\nconst LINKING_ERROR =\n  `The package 'react-native-facetec' doesn't seem to be linked. Make sure: \\n\\n` +\n  Platform.select({ ios: \"- You have run 'pod install'\\n\", default: '' }) +\n  '- You rebuilt the app after installing the package\\n' +\n  '- You are not using Expo managed workflow\\n';\n\nconst ComponentName =\n  Platform.OS === 'ios' ? 'FaceTecView' : 'FacetecViewManager';\n\nconst UIManager = UIManagerWithMissingProp as UIManagerStatic & {\n  FacetecViewManager: any;\n};\n\nconst FacetecViewManager =\n  UIManager.getViewManagerConfig(ComponentName) != null\n    ? requireNativeComponent<Types.FacetecProps>(ComponentName)\n    : () => {\n        throw new Error(LINKING_ERROR);\n      };\n\nconst Facetec = NativeModules.Facetec\n  ? NativeModules.Facetec\n  : new Proxy(\n      {},\n      {\n        get() {\n          throw new Error(LINKING_ERROR);\n        },\n      }\n    );\n\nconst createFragment = (viewId: number | null) =>\n  UIManager.dispatchViewManagerCommand(\n    viewId,\n    // we are calling the 'create' command\n    UIManager.FacetecViewManager.Commands.create.toString(),\n    [viewId]\n  );\n\nconst AndroidFacetecView = ({\n  mode,\n  show = false,\n  onStateUpdate,\n  vocalGuidanceMode,\n  config,\n  customization = defaultCustomization,\n}: Types.FacetecViewProps) => {\n  const ref = useRef(null);\n\n  const onUpdate = (event: any) => {\n    const status = event?.nativeEvent?.status as Types.FacetecStatus;\n    const faceScanBase64 = event?.nativeEvent?.faceScanBase64 as String;\n    if (onStateUpdate && status)\n      onStateUpdate({\n        status,\n        load: {\n          faceScanBase64,\n        },\n      });\n  };\n\n  useEffect(() => {\n    if (show) {\n      const viewId = findNodeHandle(ref.current);\n      createFragment(viewId);\n    }\n  }, [show]);\n\n  if (!show) return null;\n\n  return (\n    <FacetecViewManager\n      style={{\n        // converts dpi to px, provide desired height\n        height: PixelRatio.getPixelSizeForLayoutSize(0),\n        // converts dpi to px, provide desired width\n        width: PixelRatio.getPixelSizeForLayoutSize(0),\n      }}\n      {...config}\n      // @ts-ignore\n      mode={mode}\n      vocalGuidanceMode={vocalGuidanceMode}\n      onUpdate={onUpdate}\n      customization={customization}\n      ref={ref}\n    />\n  );\n};\n\nconst IOSFacetecView = ({}) => {\n  // @ts-ignore\n  return <FacetecViewManager style={{ flex: 1 }} />;\n};\n\nfunction initialize(config: Types.FacetecConfig): Promise<boolean> {\n  const {\n    productionKeyText,\n    deviceKeyIdentifier,\n    faceScanEncryptionKey,\n    sessionToken,\n  } = config;\n  return Facetec.init(\n    productionKeyText,\n    deviceKeyIdentifier,\n    faceScanEncryptionKey,\n    sessionToken\n  );\n}\n\nconst FacetecView = Platform.select({\n  ios: IOSFacetecView,\n  android: AndroidFacetecView,\n});\n\ntype FacetecViewProps = Types.FacetecViewProps;\ntype FacetecViewConfig = Types.FacetecViewConfig;\ntype FacetecStatus = Types.FacetecStatus;\ntype FacetecState = Types.FacetecState;\nexport {\n  defaultCustomization,\n  initialize,\n  FacetecView,\n  FacetecViewProps,\n  FacetecViewConfig,\n  FacetecStatus,\n  FacetecState,\n};\n"],"mappings":";;;;;;;;;;;;;AAAA;AAEA;AASA;AAAuD;AAAA;AAAA;AAEvD,MAAMA,aAAa,GAChB,+EAA8E,GAC/EC,qBAAQ,CAACC,MAAM,CAAC;EAAEC,GAAG,EAAE,gCAAgC;EAAEC,OAAO,EAAE;AAAG,CAAC,CAAC,GACvE,sDAAsD,GACtD,6CAA6C;AAE/C,MAAMC,aAAa,GACjBJ,qBAAQ,CAACK,EAAE,KAAK,KAAK,GAAG,aAAa,GAAG,oBAAoB;AAE9D,MAAMC,SAAS,GAAGC,sBAEjB;AAED,MAAMC,kBAAkB,GACtBF,SAAS,CAACG,oBAAoB,CAACL,aAAa,CAAC,IAAI,IAAI,GACjD,IAAAM,mCAAsB,EAAqBN,aAAa,CAAC,GACzD,MAAM;EACJ,MAAM,IAAIO,KAAK,CAACZ,aAAa,CAAC;AAChC,CAAC;AAEP,MAAMa,OAAO,GAAGC,0BAAa,CAACD,OAAO,GACjCC,0BAAa,CAACD,OAAO,GACrB,IAAIE,KAAK,CACP,CAAC,CAAC,EACF;EACEC,GAAG,GAAG;IACJ,MAAM,IAAIJ,KAAK,CAACZ,aAAa,CAAC;EAChC;AACF,CAAC,CACF;AAEL,MAAMiB,cAAc,GAAIC,MAAqB,IAC3CX,SAAS,CAACY,0BAA0B,CAClCD,MAAM;AACN;AACAX,SAAS,CAACE,kBAAkB,CAACW,QAAQ,CAACC,MAAM,CAACC,QAAQ,EAAE,EACvD,CAACJ,MAAM,CAAC,CACT;AAEH,MAAMK,kBAAkB,GAAG,QAOG;EAAA,IAPF;IAC1BC,IAAI;IACJC,IAAI,GAAG,KAAK;IACZC,aAAa;IACbC,iBAAiB;IACjBC,MAAM;IACNC,aAAa,GAAGC;EACM,CAAC;EACvB,MAAMC,GAAG,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EAExB,MAAMC,QAAQ,GAAIC,KAAU,IAAK;IAAA;IAC/B,MAAMC,MAAM,GAAGD,KAAK,aAALA,KAAK,6CAALA,KAAK,CAAEE,WAAW,uDAAlB,mBAAoBD,MAA6B;IAChE,MAAME,cAAc,GAAGH,KAAK,aAALA,KAAK,8CAALA,KAAK,CAAEE,WAAW,wDAAlB,oBAAoBC,cAAwB;IACnE,IAAIX,aAAa,IAAIS,MAAM,EACzBT,aAAa,CAAC;MACZS,MAAM;MACNG,IAAI,EAAE;QACJD;MACF;IACF,CAAC,CAAC;EACN,CAAC;EAED,IAAAE,gBAAS,EAAC,MAAM;IACd,IAAId,IAAI,EAAE;MACR,MAAMP,MAAM,GAAG,IAAAsB,2BAAc,EAACT,GAAG,CAACU,OAAO,CAAC;MAC1CxB,cAAc,CAACC,MAAM,CAAC;IACxB;EACF,CAAC,EAAE,CAACO,IAAI,CAAC,CAAC;EAEV,IAAI,CAACA,IAAI,EAAE,OAAO,IAAI;EAEtB,oBACE,6BAAC,kBAAkB;IACjB,KAAK,EAAE;MACL;MACAiB,MAAM,EAAEC,uBAAU,CAACC,yBAAyB,CAAC,CAAC,CAAC;MAC/C;MACAC,KAAK,EAAEF,uBAAU,CAACC,yBAAyB,CAAC,CAAC;IAC/C;EAAE,GACEhB,MAAM;IACV;IACA,IAAI,EAAEJ,IAAK;IACX,iBAAiB,EAAEG,iBAAkB;IACrC,QAAQ,EAAEM,QAAS;IACnB,aAAa,EAAEJ,aAAc;IAC7B,GAAG,EAAEE;EAAI,GACT;AAEN,CAAC;AAED,MAAMe,cAAc,GAAG,SAAQ;EAAA,IAAP,CAAC,CAAC;EACxB;EACA,oBAAO,6BAAC,kBAAkB;IAAC,KAAK,EAAE;MAAEC,IAAI,EAAE;IAAE;EAAE,EAAG;AACnD,CAAC;AAED,SAASC,UAAU,CAACpB,MAA2B,EAAoB;EACjE,MAAM;IACJqB,iBAAiB;IACjBC,mBAAmB;IACnBC,qBAAqB;IACrBC;EACF,CAAC,GAAGxB,MAAM;EACV,OAAOf,OAAO,CAACwC,IAAI,CACjBJ,iBAAiB,EACjBC,mBAAmB,EACnBC,qBAAqB,EACrBC,YAAY,CACb;AACH;AAEA,MAAME,WAAW,GAAGrD,qBAAQ,CAACC,MAAM,CAAC;EAClCC,GAAG,EAAE2C,cAAc;EACnBS,OAAO,EAAEhC;AACX,CAAC,CAAC;AAAC"}